!function(t){"use strict";function e(t,e){return e.constructor===Array?(e.push(t),e):"function"==typeof e?[e,t]:"undefined"==typeof e?t:void 0}function r(t){for(;y&&b.length;){if(!v.horizontal){for(var e=Math.max(Math.floor(a()/v.bucketSize)-v.bucketBuffer,0),r=Math.min(Math.ceil(o()/v.bucketSize)+v.bucketBuffer,b.length-1),l=e;r>l;l++)b[l].loaded||m(b[l]);return}if(!(g[0].left-v.threshold<t))return;n(g[0]),g.shift()}}function n(t){var e,r;t.cb&&(r=v.showCB[t.cb](t)),"img"===t.type?(e=new Image,e.src=r||t.src,e.alt=t.alt,e.setAttribute("class","snorlax-loaded")):(e=document.createElement("iframe"),e.src=t.src),e.setAttribute("class",t.el.getAttribute("class").replace(v.cssClassPrefix,v.cssClassPrefix+"-loaded"));var n=t.el.dataset||i(t.el),o=v.attrPrefix.replace(/^data-/,"").replace(/-/g,"");for(var a in n)n.hasOwnProperty(a)&&-1===[o+"src",o+"alt",o+"cb"].indexOf(a.toLowerCase())&&(e.dataset?e.dataset[a]=n[a]:e.setAttribute("data-"+a.replace(/[a-z][A-Z][a-z]/g,function(t,e){return t.substr(0,1)+"-"+t.substr(1).toLowerCase()}),n[a]));"img"===t.type?e.onload=function(){t.el.parentNode.insertBefore(e,t.el),t.el.style.display="none"}:(t.el.parentNode.insertBefore(e,t.el),t.el.style.display="none")}function o(){var e=t.innerHeight||document.documentElement.clientHeight;return a()+e}function a(){return document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop}function l(){var t=document.getElementById(v.wrap).parentElement;return t.scrollLeft+1*window.getComputedStyle(t).width.replace("px","")}function c(t){return{el:t,top:t.getBoundingClientRect().top+a(),left:t.getBoundingClientRect().left,bottom:t.getBoundingClientRect().bottom+a(),src:t.getAttribute(v.attrPrefix+"-src"),alt:t.getAttribute(v.attrPrefix+"-alt"),cb:t.getAttribute(v.attrPrefix+"-cb"),type:/^https?:\/\/(?:[a-z\-]+\.)+[a-z]{2,6}(?:\/[^\/#?]+)+\.(?:jpe?g|gif|png)$/i.test(t.getAttribute(v.attrPrefix+"-src"))?"img":"iframe",loaded:!1}}function i(t){for(var e={},r=0;r<t.attributes.length;r++){var n=t.attributes[r];n.specified&&n.name.match(/^data-/)&&n.name.match(/^data-./).length>0&&(e[n.name.replace(/^data-/,"").replace(/-./g,function(t,e){return t.charAt(1).toUpperCase()})]=n.value)}return e}function s(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r]);return e}function u(t,e,r){t.addEventListener?t.addEventListener(e,r):t.attachEvent("on"+e,r)}function f(t){return document.getElementsByClassName?document.getElementsByClassName(t):document.querySelectorAll("."+t)}function d(){Array.prototype.indexOf=function(t,e){void 0===e&&(e=0),0>e&&(e+=this.length),0>e&&(e=0);for(var r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1}}function p(t,e){if("function"==typeof t)t(e);else{if(t.constructor!==Array)throw"callback must be a function or array of functions";for(var r=0;r<t.length;r++){if("function"!=typeof t[r])throw"A callback must be function";t[r](e)}}}function h(t){for(var e=document.body,r=document.documentElement,n=Math.max(e.scrollHeight,e.offsetHeight,r.clientHeight,r.scrollHeight,r.offsetHeight),o=Math.ceil(n/v.bucketSize),a=0;o>a;a++)b[a]={_id:a,loaded:!1,elements:[]};for(var a=0;a<t.length;a++)for(var l=Math.floor(t[a].top/v.bucketSize),c=Math.ceil((t[a].bottom-t[a].top)/v.bucketSize),i=l;l+c>i;i++)b[i].elements.push(t[a])}function m(t){for(var e=0;e<t.elements.length;e++)t.elements[e].loaded||(n(t.elements[e]),t.elements[e].loaded=!0);t.loaded=!0}var g=[],b=[],v={bucketSize:400,bucketBuffer:1,attrPrefix:"data-snorlax",cssClassPrefix:"snorlax",event:"scroll",horizontal:!1,wrap:"",scrollCB:[],showCB:[]},y=!0;t.Snorlax=function(e){e&&this.refreshConfig(e);var n;if("indexOf"in Array.prototype||d(),n=f(v.cssClassPrefix),g=s(n),v.horizontal){for(var a=document.getElementById(v.wrap),i=0;i<g.length;i++)g[i]=c(g[i]);var m=l(),b=function(){var t=l();r(t)};u(a.parentElement,v.event,b),r(m)}else{for(var i=0;i<g.length;i++)g[i]=c(g[i]);h(g);var m=o(),b=function(){var t=o();p(v.scrollCB,{current:t,prev:m}),Math.abs(t-m)>=v.bucketSize*v.bucketBuffer&&(m=t,r())};u(t,v.event,b),p(v.scrollCB,{current:m,prev:m}),r()}},t.Snorlax.prototype.loadAll=function(){for(;b.length;)m(b[0]),b.shift()},t.Snorlax.prototype.refreshConfig=function(t){for(var e=Object.keys(t),r=0;r<e.length;r++)v[e[r]]=t[e[r]]},t.Snorlax.prototype.start=function(){y=!0},t.Snorlax.prototype.stop=function(){y=!1},t.Snorlax.prototype.addScrollCallback=function(t){v.scrollCB=e(t,v.scrollCB)}}(window);