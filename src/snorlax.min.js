!function(t){"use strict";function e(t,e){return e.constructor===Array?e.push(t):"function"==typeof e?[e,t]:"undefined"==typeof e?t:void 0}function n(t){for(v=v||h();b&&m.length;)if(y.horizontal){if(p(),!(m[0].left-y.threshold<t))return;r(m[0]),m.shift()}else{var e=l()-y.threshold,n=o()+y.threshold;if(p(v),p(v-1),m[v].top>e&&m[v].bottom<n)r(m[v]),m.splice(v,1),v>m.length-1&&v--;else{if(!(v>0&&m[v-1].top>e&&m[v-1].bottom<n))return;r(m[v-1]),m.splice(v-1,1),v--}}}function r(t){var e,n;t.cb&&(n=y.showCB[t.cb](t)),"img"===t.type?(e=new Image,e.src=n||t.src,e.alt=t.alt,e.setAttribute("class","snorlax-loaded")):(e=document.createElement("iframe"),e.src=t.src),e.setAttribute("class",t.el.getAttribute("class").replace(y.cssClassPrefix,y.cssClassPrefix+"-loaded"));var r=t.el.dataset||c(t.el),o=y.attrPrefix.replace(/^data-/,"").replace(/-/g,"");for(var l in r)r.hasOwnProperty(l)&&-1===[o+"src",o+"alt",o+"cb"].indexOf(l.toLowerCase())&&(e.dataset?e.dataset[l]=r[l]:e.setAttribute("data-"+l.replace(/[a-z][A-Z][a-z]/g,function(t,e){return t.substr(0,1)+"-"+t.substr(1).toLowerCase()}),r[l]));"img"===t.type?e.onload=function(){t.el.parentNode.insertBefore(e,t.el),t.el.style.display="none"}:(t.el.parentNode.insertBefore(e,t.el),t.el.style.display="none")}function o(){var e=t.innerHeight||document.documentElement.clientHeight;return l()+e}function l(){return document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop}function a(){var t=document.getElementById(y.wrap).parentElement;return t.scrollLeft+1*window.getComputedStyle(t).width.replace("px","")}function i(t){return{el:t,top:t.getBoundingClientRect().top+l(),left:t.getBoundingClientRect().left,bottom:t.getBoundingClientRect().bottom+l(),src:t.getAttribute(y.attrPrefix+"-src"),alt:t.getAttribute(y.attrPrefix+"-alt"),cb:t.getAttribute(y.attrPrefix+"-cb"),type:/^https?:\/\/(?:[a-z\-]+\.)+[a-z]{2,6}(?:\/[^\/#?]+)+\.(?:jpe?g|gif|png)$/i.test(t.getAttribute(y.attrPrefix+"-src"))?"img":"iframe"}}function c(t){for(var e={},n=0;n<t.attributes.length;n++){var r=t.attributes[n];r.specified&&r.name.match(/^data-/)&&r.name.match(/^data-./).length>0&&(e[r.name.replace(/^data-/,"").replace(/-./g,function(t,e){return t.charAt(1).toUpperCase()})]=r.value)}return e}function s(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e}function u(t,e,n){t.addEventListener?t.addEventListener(e,n):t.attachEvent("on"+e,n)}function f(t){return document.getElementsByClassName?document.getElementsByClassName(t):document.querySelectorAll("."+t)}function d(){Array.prototype.indexOf=function(t,e){void 0===e&&(e=0),0>e&&(e+=this.length),0>e&&(e=0);for(var n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1}}function p(t){t=t||v,m.length&&t>-1&&m.length>t&&(m[t].top=m[t].el.getBoundingClientRect().top+l(),m[t].left=m[t].el.getBoundingClientRect().left)}function h(){for(var t=l(),e=0;e<m.length;e++)if(m[e].top>t)return e;return m.length-1}function g(t,e){if("function"==typeof t)t(e);else{if(t.constructor!==Array)throw"callback must be a function or array of functions";for(var n=0;n<t.length;n++){if("function"!=typeof t[n])throw"A callback must be function";t[n](e)}}}var m=[],y={threshold:600,attrPrefix:"data-snorlax",cssClassPrefix:"snorlax",scrollDelta:600,event:"scroll",horizontal:!1,wrap:"",scrollCB:[],showCB:[]},v=0,b=!0;t.Snorlax=function(e){e&&this.refreshConfig(e);var r;if("indexOf"in Array.prototype||d(),r=f(y.cssClassPrefix),m=s(r),y.horizontal){for(var l=document.getElementById(y.wrap),c=0;c<m.length;c++)m[c]=i(m[c]);var p=a(),h=function(){var t=a();n(t)};u(l.parentElement,y.event,h),n(p)}else{for(var c=0;c<m.length;c++)m[c]=i(m[c]);var p=o(),h=function(){var t=o();g(y.scrollCB,{current:t,prev:p}),Math.abs(t-p)>=y.scrollDelta&&(p=t,n())};u(t,y.event,h),g(y.scrollCB,{current:p,prev:p}),n()}},t.Snorlax.prototype.loadAll=function(){for(;m.length;)r(m[0]),m.shift()},t.Snorlax.prototype.refreshConfig=function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)y[e[n]]=t[e[n]]},t.Snorlax.prototype.start=function(){b=!0},t.Snorlax.prototype.stop=function(){b=!1},t.Snorlax.prototype.addScrollCallback=function(t){y.scrollCB=e(t,y.scrollCB)},t.Snorlax.prototype.addShowCallback=function(t){y.scrollCB=e(t,y.showCB)}}(window);